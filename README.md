# nwpc-message-tool

Tools for nwpc-message-client.

## Introduction

`nwpc-message-client` supports two message types:

- NMC Monitor Platform: messages are created and stored by [nwpc-oper/nmc-message-client](https://github.com/nwpc-oper/nmc-message-client)
- NWPC Message Platform: messages are created and stored by [nwpc-oper/nwpc-message-client](https://github.com/nwpc-oper/nwpc-message-client)

Messages from different platforms may store in different ElasticSearch servers. 

## Getting started

Use `python -m nwpc-message-tool` to run command line tool.

### Draw step_grid plot

Draw production grid plot by step (step_grid).

Use NMC monitoring platform data to analytic 00 cycle of GRAPES GFS from March 11, 2020 to March 21, 2020.

```shell script
python -m nwpc-message-tool plot \
    --engine=nmc_monitor \
    --elastic-server localhost:9200 \
    --system grapes_gfs_gmf \
    --start-time 2020031100/2020032118 \
    --start-time-freq=D \
    --output-file=w.html \
    --plot-type=step_grid
```

The command will open a web browser to show the web page generated by bokeh.

### Draw period_bar plot

Draw production period bar plot (period_bar).

Use NWPC message platform data to analytic 00 cycle of GRAPES GFS from March 11, 2020 to March 21, 2020.

```shell script
python -m nwpc-message-tool plot \
    --engine=nwpc_message \
    --elastic-server localhost:9200 \
    --system grapes_meso_3km \
    --start-time 2020031100/2020032118 \
    --start-time-freq=D \
    --output-file=w.html \
    --plot-type=period_bar
```

### Create time table

Create a time table of for each step production, and write it into a json file.

Use NMC monitoring platform data to analytic 18 cycle of GRAPES GFS from March 17, 2020 to March 21, 2020.

```shell script
nwpc_message_tool table \
    --engine=nmc_monitor \
    --elastic-server localhost:9200 \
    --system grapes_gfs_gmf \
    --start-time 2020031700/2020032118 \
    --output-type=json \
    --output-file=w.json
```

More examples are under `example` directory.

## LICENSE

Copyright &copy; 2020 perillaroc at nwpc-oper.

`nwpc-message-tool` is license under [GPL v3.0](./LICENSE.md).